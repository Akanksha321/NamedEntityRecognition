{"cells":[{"metadata":{"_uuid":"ba2cb659-cfb2-477a-b1d8-a260bcb52e8c","_cell_guid":"24bc1074-d09a-4ef5-b1b7-de4cef120dcd","trusted":true},"cell_type":"code","source":"# %% [code] {\"_kg_hide-output\":true}\n#!pip install git+https://www.github.com/keras-team/keras-contrib.git\n\n# %% [code]\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\nimport keras\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom keras_contrib.layers import CRF\nfrom keras.utils import to_categorical\nfrom keras.models import Model, Input\nfrom keras.layers import LSTM, Embedding, Dense, TimeDistributed, Dropout, Bidirectional\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score,f1_score,recall_score,precision_score, classification_report\nimport logging\nimport warnings\nwarnings.filterwarnings('ignore')\nlogger = logging.getLogger(__name__)\n# Any results you write to the current directory are saved as output.\n\n# %% [code]\ninvoice_df = pd.read_csv(\"../input/nerdataset/LabelledDataNER.csv\", encoding = \"ISO-8859-1\", error_bad_lines=False)\ninvoice_df.head(n=2)\nlogger.info(\"***** Reading dataset completed *****\")\nlogger.info(\" Size of dataset = %d\", len(invoice_df))\n\n\n# %% [code]\ninvoice_df.drop('Filename',axis=1, inplace = True)\ninvoice_data =invoice_df.copy()\n\n# %% [code]\n\"Function to get sentences separately\"\ndef sentence_getter(sent):\n    agg_func = lambda s: [(w, t) for w,t in zip(s[\"Word\"].values.tolist(),\n                                                        s[\"Label\"].values.tolist())]\n    grouped = invoice_data.groupby(\"SentenceID\").apply(agg_func)\n    sentences = [s for s in grouped]\n    return sentences\n\nsentences=sentence_getter(invoice_data)\n\nmaxlen = max([len(s) for s in sentences])\nprint ('Maximum sequence length:', maxlen)\n\n\n# %% [code]\n#Words distribution across Labels\nimport seaborn as sns\nplt.figure(figsize=(10, 5))\nax = sns.countplot('Label', data=invoice_data.loc[invoice_data['Label'] != 'Other'])\nax.set_xticklabels(ax.get_xticklabels(), rotation=90, ha=\"center\")\nplt.tight_layout()\nplt.show()\n\n# %% [code]\nwords = list(set(invoice_data[\"Word\"].values)) #unique words\nn_words = len(words) #no of unique words\nlabels = list(set(invoice_data[\"Label\"].values))  #unique labels\nn_labels = len(labels) #no of tags\n\n\n# %% [code]\n\"Converting words to numbers and numbers to words\"\nfrom future.utils import iteritems\nword2id = {w: i for i, w in enumerate(words)}\ntag2id = {t: i for i, t in enumerate(labels)}\nid2tag = {v: k for k, v in iteritems(tag2id)}\n\n# %% [code]\nfrom keras.preprocessing.sequence import pad_sequences\nX = [[word2id[w[0]] for w in s] for s in sentences]\nX = pad_sequences(maxlen=175, sequences=X, padding=\"post\",value=0)\n\ny = [[tag2id[w[1]] for w in s] for s in sentences]\ny = pad_sequences(maxlen=175, sequences=y, padding=\"post\", value=1)\ny = [to_categorical(i, num_classes=n_labels) for i in y]\n\ninput = Input(shape=(175,))\nword_embedding_size = 200\nmodel = Embedding(input_dim=n_words, output_dim=word_embedding_size, input_length=175)(input)\nmodel=Dropout(0.2)(model)\nmodel = Bidirectional(LSTM(units=word_embedding_size, \n                           return_sequences=True, \n                          dropout = 0.1\n                           ))(model)\nmodel = TimeDistributed(Dense(n_labels, activation=\"relu\"))(model)  \n\ncrf = CRF(n_labels)  # CRF layer\nout = crf(model)  # output\nmodel = Model(input, out)\nmodel.summary()\n\n# %% [code]\n#adam = k.optimizers.Adam(lr=0.0005)\nmodel.compile(optimizer='adam', loss=crf.loss_function, metrics=[crf.accuracy, 'accuracy'])\n\n# %% [code] {\"scrolled\":true,\"_kg_hide-output\":true}\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1)\n# Train!\nlogger.info(\"***** Running training *****\")\nlogger.info(\"  Num examples = %d\", len(X_train))\nhistory = model.fit(X_train, np.array(y_train), batch_size=32, epochs=6, validation_split=0.2, verbose=1) #training the model\n\n# %% [code]\npred = model.predict(np.array([X_test[0]]))\npred = np.argmax(pred, axis=-1)\ngt = np.argmax(y_test[0], axis=-1)\nprint(gt)\nprint(\"{:14}: ({:5}): {}\".format(\"Word\", \"True\", \"Pred\"))\nfor idx, (w,pred) in enumerate(zip(X_test[0],pred[0])):\n    #\n    print(\"{:14}: ({:15}): {}\".format(words[w],id2tag[gt[idx]],labels[pred]))\n\n# %% [code]\npred = model.predict(np.array(X_test))  \n\n# %% [markdown]\n# ## Standard Classification Report\n\n# %% [code]\n\nprint(classification_report(np.argmax(y_test, 2).ravel(), np.argmax(pred, axis=2).ravel(),labels=list(id2tag.keys()), target_names=list(id2tag.values())))\n\n# %% [code]\nfrom sklearn.metrics import accuracy_score,f1_score,recall_score,precision_score\nF1_score=f1_score(y_test[0],pred[0],average='weighted')\nprint(\"F1 score:\",F1_score)\n\n# %% [code] {\"_kg_hide-output\":true}\n##!pip install transformers\n\n# %% [code]\n#from transformers import BertTokenizer, BertConfig\n\n# %% [code]\n#tokenizer = BertTokenizer.from_pretrained('bert-base-cased', do_lower_case=False) \n\n# %% [code]\n","execution_count":17,"outputs":[{"output_type":"stream","text":"Maximum sequence length: 175\n","name":"stdout"},{"output_type":"display_data","data":{"text/plain":"<Figure size 720x360 with 1 Axes>","image/png":"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\n"},"metadata":{"needs_background":"light"}},{"output_type":"stream","text":"_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\ninput_15 (InputLayer)        (None, 175)               0         \n_________________________________________________________________\nembedding_15 (Embedding)     (None, 175, 200)          141800    \n_________________________________________________________________\ndropout_5 (Dropout)          (None, 175, 200)          0         \n_________________________________________________________________\nbidirectional_15 (Bidirectio (None, 175, 400)          641600    \n_________________________________________________________________\ntime_distributed_15 (TimeDis (None, 175, 11)           4411      \n_________________________________________________________________\ncrf_15 (CRF)                 (None, 175, 11)           275       \n=================================================================\nTotal params: 788,086\nTrainable params: 788,086\nNon-trainable params: 0\n_________________________________________________________________\nTrain on 6 samples, validate on 2 samples\nEpoch 1/6\n6/6 [==============================] - 11s 2s/step - loss: 2.6229 - crf_viterbi_accuracy: 0.0038 - acc: 0.0038 - val_loss: 2.5612 - val_crf_viterbi_accuracy: 0.0029 - val_acc: 0.0029\nEpoch 2/6\n6/6 [==============================] - 0s 73ms/step - loss: 2.5719 - crf_viterbi_accuracy: 0.0067 - acc: 0.0038 - val_loss: 2.4808 - val_crf_viterbi_accuracy: 0.0057 - val_acc: 0.0057\nEpoch 3/6\n6/6 [==============================] - 1s 90ms/step - loss: 2.5051 - crf_viterbi_accuracy: 0.0057 - acc: 0.0038 - val_loss: 2.3667 - val_crf_viterbi_accuracy: 0.1743 - val_acc: 0.1743\nEpoch 4/6\n6/6 [==============================] - 1s 99ms/step - loss: 2.4013 - crf_viterbi_accuracy: 0.1352 - acc: 0.0038 - val_loss: 2.2130 - val_crf_viterbi_accuracy: 0.1771 - val_acc: 0.1771\nEpoch 5/6\n6/6 [==============================] - 1s 89ms/step - loss: 2.2712 - crf_viterbi_accuracy: 0.1495 - acc: 0.0038 - val_loss: 1.9962 - val_crf_viterbi_accuracy: 0.5029 - val_acc: 0.5029\nEpoch 6/6\n6/6 [==============================] - 0s 75ms/step - loss: 2.0836 - crf_viterbi_accuracy: 0.4800 - acc: 0.0038 - val_loss: 1.6564 - val_crf_viterbi_accuracy: 0.6457 - val_acc: 0.6457\n[6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6\n 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6\n 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6\n 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 1 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6\n 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6]\nWord          : (True ): Pred\nted           : (Other          ): I-CustomerName\nbates         : (Other          ): E-InvoiceDate\na             : (Other          ): I-CustomerName\ncompany.inc   : (Other          ): E-InvoiceDate\nfadvertising  : (Other          ): I-CustomerName\n1218          : (Other          ): E-InvoiceDate\neronaway      : (Other          ): I-CustomerName\nnew           : (Other          ): E-InvoiceDate\nyor           : (Other          ): I-CustomerName\nnese          : (Other          ): E-InvoiceDate\nyork          : (Other          ): I-CustomerName\n10095.usa     : (Other          ): E-InvoiceDate\nf             : (Other          ): I-CustomerName\nprema         : (Other          ): E-InvoiceDate\n217           : (Other          ): I-CustomerName\nate           : (Other          ): E-InvoiceDate\nem            : (Other          ): I-CustomerName\ncanna         : (Other          ): E-InvoiceDate\ngatenererd    : (Other          ): I-CustomerName\naum           : (Other          ): E-InvoiceDate\nyork          : (Other          ): Other\none           : (Other          ): B-TotalAmount\nient          : (Other          ): B-CustomerName\now            : (Other          ): Other\ngrown         : (Other          ): B-TotalAmount\nwilliamson    : (Other          ): B-CustomerName\ntobacco       : (Other          ): Other\ncorp          : (Other          ): B-TotalAmount\nproouctignh   : (Other          ): B-CustomerName\nestimate      : (Other          ): Other\nreport        : (Other          ): B-TotalAmount\nacis          : (Other          ): B-CustomerName\nwoe           : (Other          ): Other\naot           : (Other          ): B-TotalAmount\nlling         : (Other          ): B-CustomerName\ntype          : (Other          ): Other\nprogressive   : (Other          ): B-TotalAmount\nmeta          : (Other          ): I-CustomerName\nrint          : (Other          ): E-InvoiceDate\nbaodn         : (Other          ): I-CustomerName\nrun           : (Other          ): E-InvoiceDate\nch            : (Other          ): I-CustomerName\naprzist       : (Other          ): E-InvoiceDate\nat            : (Other          ): I-CustomerName\n1a            : (Other          ): E-InvoiceDate\npage          : (Other          ): I-CustomerName\n2             : (Other          ): E-InvoiceDate\naor           : (Other          ): I-CustomerName\npmlbo4        : (Other          ): E-InvoiceDate\nlike          : (Other          ): I-CustomerName\nyen           : (Other          ): E-InvoiceDate\nlong          : (Other          ): I-CustomerName\nput           : (Other          ): E-InvoiceDate\nrate          : (Other          ): I-CustomerName\nser           : (Other          ): E-InvoiceDate\nstiong        : (Other          ): I-CustomerName\nan-pr-t7-3    : (Other          ): E-InvoiceDate\nkote          : (Other          ): I-CustomerName\n76-90         : (Other          ): E-InvoiceDate\ncomm.         : (Other          ): I-CustomerName\nvertsl        : (Other          ): E-InvoiceDate\nspr           : (Other          ): I-CustomerName\nungs          : (Other          ): E-InvoiceDate\na/f           : (Other          ): Other\nngs           : (Other          ): B-TotalAmount\ngilling       : (Other          ): B-CustomerName\n1600          : (Other          ): Other\nw             : (Other          ): B-TotalAmount\nhill          : (Other          ): B-CustomerName\nst            : (Other          ): Other\n19727         : (Other          ): B-TotalAmount\ntimefessence/t: (Other          ): B-CustomerName\nguidezjet/ng  : (Other          ): Other\ngalls         : (Other          ): B-TotalAmount\n47            : (Other          ): B-CustomerName\nbld           : (Other          ): Other\nagoress       : (Other          ): B-TotalAmount\nleuisville    : (Other          ): B-CustomerName\nkw            : (Other          ): Other\n40202         : (Other          ): B-TotalAmount\nphotog-       : (Other          ): B-CustomerName\nalpha         : (Other          ): Other\nfp            : (Other          ): B-TotalAmount\n10267         : (Other          ): B-CustomerName\ncoma          : (Other          ): Other\nls$1on        : (Other          ): B-TotalAmount\noriel         : (Other          ): B-CustomerName\nwal           : (Other          ): Other\nresent        : (Other          ): B-TotalAmount\nrate          : (Other          ): B-CustomerName\nestimate      : (Other          ): Other\nestimate      : (Other          ): B-TotalAmount\n44            : (Other          ): B-CustomerName\npuotosmeuns   : (Other          ): Other\nfee           : (Other          ): B-TotalAmount\n1300200       : (Other          ): B-CustomerName\n6             : (Other          ): Other\ncla           : (Other          ): B-TotalAmount\nprnt-ove      : (Other          ): B-CustomerName\ntr            : (Other          ): Other\n225           : (Other          ): B-TotalAmount\ng9            : (Other          ): B-CustomerName\nretouching    : (Other          ): Other\n40000         : (Other          ): B-TotalAmount\n21            : (Other          ): B-CustomerName\nphotostats    : (Other          ): Other\n75200         : (Other          ): B-TotalAmount\naz            : (Other          ): B-CustomerName\nmechanicals   : (Other          ): Other\n223200        : (Other          ): B-TotalAmount\n42            : (Other          ): B-CustomerName\ntaansp        : (Other          ): Other\nor            : (Other          ): B-TotalAmount\nehcses.       : (Other          ): B-CustomerName\n150200        : (Other          ): Other\n44            : (Other          ): B-TotalAmount\ntreotnarets   : (Other          ): B-CustomerName\n180           : (Other          ): Other\npenanss       : (Other          ): B-TotalAmount\n25200         : (Other          ): B-CustomerName\n70            : (Other          ): Other\nmev.          : (Other          ): B-TotalAmount\nsmes          : (Other          ): B-CustomerName\nfax           : (Other          ): Other\n207.2         : (Other          ): B-TotalAmount\nfoals         : (Other          ): B-CustomerName\n2197.2        : (Other          ): Other\n2797-20       : (Other          ): B-TotalAmount\ncome          : (Other          ): B-CustomerName\n1$5i0ns       : (Other          ): Other\ntotals        : (Other          ): B-TotalAmount\nlorass        : (Other          ): B-CustomerName\n2797.2        : (B-TotalAmount  ): Other\nweg           : (Other          ): B-TotalAmount\ngaestocr      : (Other          ): B-CustomerName\nphotdgraphy   : (Other          ): Other\nprice         : (Other          ): B-TotalAmount\nfor           : (Other          ): B-CustomerName\nall           : (Other          ): Other\nmedia         : (Other          ): B-TotalAmount\necr           : (Other          ): B-CustomerName\nsone          : (Other          ): Other\nyear          : (Other          ): B-TotalAmount\nwsg           : (Other          ): B-CustomerName\nlima          : (Other          ): Other\nat            : (Other          ): B-TotalAmount\n825           : (Other          ): B-CustomerName\nb/c           : (Other          ): Other\ns209          : (Other          ): B-TotalAmount\nat            : (Other          ): B-CustomerName\n7c            : (Other          ): I-CustomerName\n4203          : (Other          ): E-InvoiceDate\nat            : (Other          ): I-CustomerName\n650           : (Other          ): E-InvoiceDate\nge            : (Other          ): I-CustomerName\nip            : (Other          ): E-InvoiceDate\ntw            : (Other          ): I-CustomerName\nfila          : (Other          ): E-InvoiceDate\nthare         : (Other          ): I-CustomerName\nls            : (Other          ): E-InvoiceDate\nless          : (Other          ): I-CustomerName\nclear         : (Other          ): E-InvoiceDate\ncuts          : (Other          ): I-CustomerName\nworice.       : (Other          ): E-InvoiceDate\nat            : (Other          ): I-CustomerName\n19            : (Other          ): E-InvoiceDate\noda           : (Other          ): I-CustomerName\nto            : (Other          ): E-InvoiceDate\nthe           : (Other          ): I-CustomerName\npity          : (Other          ): E-InvoiceDate\nof            : (Other          ): I-CustomerName\nthe           : (Other          ): E-InvoiceDate\ndocument      : (Other          ): I-CustomerName\nweieg         : (Other          ): E-InvoiceDate\nfilo.         : (Other          ): I-CustomerName\n                 precision    recall  f1-score   support\n\n  I-InvoiceDate       0.00      0.00      0.00         0\n  B-TotalAmount       0.00      0.00      0.00         1\n  I-TotalAmount       0.00      0.00      0.00         0\nI-InvoiceNumber       0.00      0.00      0.00         0\n E-CustomerName       0.00      0.00      0.00         0\nB-InvoiceNumber       0.00      0.00      0.00         0\n          Other       0.97      0.20      0.33       174\n  B-InvoiceDate       0.00      0.00      0.00         0\n B-CustomerName       0.00      0.00      0.00         0\n  E-InvoiceDate       0.00      0.00      0.00         0\n I-CustomerName       0.00      0.00      0.00         0\n\n      micro avg       0.19      0.19      0.19       175\n      macro avg       0.09      0.02      0.03       175\n   weighted avg       0.97      0.19      0.32       175\n\nF1 score: 0.32349965823650034\n","name":"stdout"}]}],"metadata":{"kernelspec":{"language":"python","display_name":"Python 3","name":"python3"},"language_info":{"pygments_lexer":"ipython3","nbconvert_exporter":"python","version":"3.6.4","file_extension":".py","codemirror_mode":{"name":"ipython","version":3},"name":"python","mimetype":"text/x-python"}},"nbformat":4,"nbformat_minor":4}